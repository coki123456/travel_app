module.exports=[36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},5909,a=>{"use strict";var b=a.i(87924),c=a.i(18402);function d(){return(0,b.jsx)("button",{onClick:()=>(0,c.signOut)({callbackUrl:"/login"}),className:"inline-flex items-center justify-center rounded-2xl border border-rose-500/40 px-5 py-2 text-sm font-semibold text-rose-200 transition hover:border-rose-400",children:"Cerrar sesión"})}a.s(["default",()=>d])},88191,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e({initialTrip:a}){let e=(0,d.useRouter)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)({name:a?.name??"",startDate:a?.startDate??"",endDate:a?.endDate??"",destinations:a?.destinations??""}),l=async b=>{b.preventDefault(),g(!0),i(null);try{let b=a?"PUT":"POST",c=a?`/api/trip/${a.id}`:"/api/trip",d=await fetch(c,{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!d.ok){let a=await d.json().catch(()=>null);i(a?.error??"Error al guardar el viaje.");return}let f=await d.json();await fetch("/api/trip/active",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:f.id})}),e.push("/"),e.refresh()}catch(a){console.error("Error al guardar viaje:",a),i("No se pudo conectar con el servidor.")}finally{g(!1)}},m=a=>{let{name:b,value:c}=a.target;k(a=>({...a,[b]:c}))};return(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-black/30",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:a?"Editar viaje":"Nuevo viaje"}),(0,b.jsxs)("form",{onSubmit:l,className:"mt-5 flex flex-col gap-4",children:[h&&(0,b.jsx)("div",{className:"rounded-xl border border-red-800 bg-red-900/20 p-3 text-sm text-red-300",children:h}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{htmlFor:"name",className:"text-sm font-medium text-slate-200",children:"Nombre del viaje"}),(0,b.jsx)("input",{type:"text",id:"name",name:"name",value:j.name,onChange:m,required:!0,maxLength:100,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 placeholder:text-slate-500 focus:border-slate-500 focus:outline-none",placeholder:"Ej: Vacaciones en Europa"})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{htmlFor:"startDate",className:"text-sm font-medium text-slate-200",children:"Fecha de inicio"}),(0,b.jsx)("input",{type:"date",id:"startDate",name:"startDate",value:j.startDate,onChange:m,required:!0,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 focus:border-slate-500 focus:outline-none"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{htmlFor:"endDate",className:"text-sm font-medium text-slate-200",children:"Fecha de fin"}),(0,b.jsx)("input",{type:"date",id:"endDate",name:"endDate",value:j.endDate,onChange:m,required:!0,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 focus:border-slate-500 focus:outline-none"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("label",{htmlFor:"destinations",className:"text-sm font-medium text-slate-200",children:"Destinos"}),(0,b.jsx)("textarea",{id:"destinations",name:"destinations",value:j.destinations,onChange:m,required:!0,maxLength:500,rows:3,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 placeholder:text-slate-500 focus:border-slate-500 focus:outline-none",placeholder:"Ej: Paris, Roma, Barcelona"})]}),(0,b.jsx)("button",{type:"submit",disabled:f,className:"mt-2 rounded-xl bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-emerald-500 disabled:cursor-not-allowed disabled:opacity-50",children:f?"Guardando...":a?"Actualizar viaje":"Crear viaje"})]})]})}a.s(["default",()=>e])},89724,a=>{"use strict";var b=a.i(87924),c=a.i(50944),d=a.i(72131);function e({tripId:a,isOpen:c,onClose:e}){let[f,g]=(0,d.useState)(""),[h,i]=(0,d.useState)("EDITOR"),[j,k]=(0,d.useState)([]),[l,m]=(0,d.useState)(!1),[n,o]=(0,d.useState)(null),[p,q]=(0,d.useState)(null);(0,d.useEffect)(()=>{c&&r()},[c,a]);let r=async()=>{try{let b=await fetch(`/api/trip/${a}/share`);if(b.ok){let a=await b.json();k(a.sharedUsers||[])}}catch(a){console.error("Error loading shared users:",a)}},s=async b=>{if(b.preventDefault(),o(null),q(null),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f))return void o("Por favor ingresa un email válido");m(!0);try{let b=await fetch(`/api/trip/${a}/share`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,role:h})}),c=await b.json();if(!b.ok)return void o(c.error||"Error al compartir el viaje");q(`Viaje compartido con ${f}`),g(""),i("EDITOR"),r()}catch(a){o("No se pudo conectar con el servidor")}finally{m(!1)}},t=async b=>{o(null),q(null);try{let c=await fetch(`/api/trip/${a}/share`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:b})});if(!c.ok){let a=await c.json();o(a.error||"Error al eliminar acceso");return}q("Acceso eliminado"),r()}catch(a){o("No se pudo conectar con el servidor")}};return c?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:e,children:(0,b.jsxs)("div",{className:"w-full max-w-md rounded-3xl border border-slate-800 bg-slate-900 p-6 shadow-lg",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Compartir viaje"}),(0,b.jsx)("button",{onClick:e,className:"text-slate-400 hover:text-slate-200",children:"✕"})]}),n&&(0,b.jsx)("div",{className:"mb-4 rounded-2xl border border-rose-500/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:n}),p&&(0,b.jsx)("div",{className:"mb-4 rounded-2xl border border-emerald-500/30 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-200",children:p}),(0,b.jsxs)("form",{onSubmit:s,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-300",children:"Email del usuario"}),(0,b.jsx)("input",{type:"email",id:"email",value:f,onChange:a=>g(a.target.value),required:!0,className:"mt-1 w-full rounded-2xl border border-slate-700 bg-slate-800 px-4 py-2 text-sm text-slate-100 placeholder-slate-500 focus:border-cyan-400 focus:outline-none",placeholder:"usuario@ejemplo.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-slate-300",children:"Permisos"}),(0,b.jsxs)("select",{id:"role",value:h,onChange:a=>i(a.target.value),className:"mt-1 w-full rounded-2xl border border-slate-700 bg-slate-800 px-4 py-2 text-sm text-slate-100 focus:border-cyan-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"EDITOR",children:"Editor (puede ver y editar)"}),(0,b.jsx)("option",{value:"VIEWER",children:"Visualizador (solo puede ver)"})]})]}),(0,b.jsx)("button",{type:"submit",disabled:l,className:"w-full rounded-2xl bg-cyan-400 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:bg-cyan-300 disabled:cursor-not-allowed disabled:opacity-70",children:l?"Compartiendo...":"Compartir"})]}),j.length>0&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("h3",{className:"mb-3 text-sm font-medium text-slate-300",children:"Usuarios con acceso"}),(0,b.jsx)("div",{className:"space-y-2",children:j.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-2xl border border-slate-800 bg-slate-900/70 px-4 py-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-100",children:a.name||a.email}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"OWNER"===a.role?"Propietario":"EDITOR"===a.role?"Editor":"Visualizador"})]}),"OWNER"!==a.role&&(0,b.jsx)("button",{onClick:()=>t(a.id),className:"text-xs text-rose-400 hover:text-rose-300",children:"Eliminar"})]},a.id))})]})]})}):null}function f({trips:a}){let f=(0,c.useRouter)(),[g,h]=(0,d.useState)(null),[i,j]=(0,d.useState)(null),[k,l]=(0,d.useState)(!1),[m,n]=(0,d.useState)(null),o=async a=>{h(null),j(a);try{let b=await fetch("/api/trip/active",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a})});if(!b.ok){let a=await b.json().catch(()=>null);h(a?.error??"No se pudo seleccionar el viaje.");return}f.push("/"),f.refresh()}catch(a){console.error("Error al seleccionar viaje:",a),h("No se pudo conectar con el servidor.")}finally{j(null)}},p=async a=>{if(window.confirm("Eliminar este viaje? Se borraran todos sus dias y elementos.")){h(null),j(a);try{let b=await fetch(`/api/trip/${a}`,{method:"DELETE"});if(!b.ok){let a=await b.json().catch(()=>null);h(a?.error??"No se pudo eliminar el viaje.");return}f.refresh()}catch(a){console.error("Error al eliminar viaje:",a),h("No se pudo conectar con el servidor.")}finally{j(null)}}};return(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-black/30",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Tus viajes"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-slate-300",children:"Selecciona un viaje para abrir su calendario."}),g?(0,b.jsx)("div",{className:"mt-4 rounded-2xl border border-rose-500/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:g}):null,(0,b.jsx)("div",{className:"mt-4 flex flex-col gap-3",children:0===a.length?(0,b.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-700 bg-slate-900/40 p-4 text-sm text-slate-400",children:"Todavia no hay viajes creados."}):a.map(a=>(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-4 shadow-lg shadow-black/20",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-100",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:a.dates}),a.destinations?(0,b.jsxs)("p",{className:"text-xs text-slate-400",children:["Destinos: ",a.destinations]}):null]}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o(a.id),disabled:i===a.id,className:"inline-flex items-center justify-center rounded-2xl bg-cyan-400 px-4 py-2 text-xs font-semibold text-slate-950 transition hover:bg-cyan-300 disabled:cursor-not-allowed disabled:opacity-70",children:i===a.id?"Abriendo...":"Usar este viaje"}),(0,b.jsx)("button",{type:"button",onClick:()=>f.push(`/setup?edit=${a.id}`),className:"inline-flex items-center justify-center rounded-2xl border border-slate-700 px-4 py-2 text-xs font-semibold text-slate-200 transition hover:border-slate-500",children:"Editar"}),(0,b.jsx)("button",{type:"button",onClick:()=>{n(a.id),l(!0)},className:"inline-flex items-center justify-center rounded-2xl border border-emerald-500/40 px-4 py-2 text-xs font-semibold text-emerald-200 transition hover:border-emerald-400",children:"Compartir"}),(0,b.jsx)("button",{type:"button",onClick:()=>p(a.id),disabled:i===a.id,className:"inline-flex items-center justify-center rounded-2xl border border-rose-500/40 px-4 py-2 text-xs font-semibold text-rose-200 transition hover:border-rose-400 disabled:cursor-not-allowed disabled:opacity-70",children:"Eliminar"})]})]},a.id))}),m&&(0,b.jsx)(e,{tripId:m,isOpen:k,onClose:()=>{l(!1),n(null)}})]})}a.s(["default",()=>f],89724)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__27761667._.js.map