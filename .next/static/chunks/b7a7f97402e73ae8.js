(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},26732,e=>{"use strict";var t=e.i(47167);e.i(43476);var a=e.i(71645);class r extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);const a=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${a}`}}class s extends r{}async function l(e,t,a,r={}){let n=`${o(t)}/${e}`;try{let e={headers:{"Content-Type":"application/json",...r?.headers?.cookie?{cookie:r.headers.cookie}:{}}};r?.body&&(e.body=JSON.stringify(r.body),e.method="POST");let t=await fetch(n,e),a=await t.json();if(!t.ok)throw a;return a}catch(e){return a.error(new s(e.message,e)),null}}function o(e){return"undefined"==typeof window?`${e.baseUrlServer}${e.basePathServer}`:e.basePath}function n(e){let t=new URL("http://localhost:3000/api/auth");e&&!e.startsWith("http")&&(e=`https://${e}`);let a=new URL(e||t),r=("/"===a.pathname?t.pathname:a.pathname).replace(/\/$/,""),s=`${a.origin}${r}`;return{origin:a.origin,host:a.host,path:r,base:s,toString:()=>s}}let i={baseUrl:n(t.default.env.NEXTAUTH_URL??t.default.env.VERCEL_URL).origin,basePath:n(t.default.env.NEXTAUTH_URL).path,baseUrlServer:n(t.default.env.NEXTAUTH_URL_INTERNAL??t.default.env.NEXTAUTH_URL??t.default.env.VERCEL_URL).origin,basePathServer:n(t.default.env.NEXTAUTH_URL_INTERNAL??t.default.env.NEXTAUTH_URL).path,_lastSync:0,_session:void 0,_getSession:()=>{}},d=null,c={debug:console.debug,error:console.error,warn:console.warn};async function u(){let e=await l("csrf",i,c);return e?.csrfToken??""}async function m(){return l("providers",i,c)}async function x(e,t,a){let{callbackUrl:r,...s}=t??{},{redirect:l=!0,redirectTo:n=r??window.location.href,...d}=s,c=o(i),x=await m();if(!x){let e=`${c}/error`;window.location.href=e;return}if(!e||!x[e]){let e=`${c}/signin?${new URLSearchParams({callbackUrl:n})}`;window.location.href=e;return}let h=x[e].type;if("webauthn"===h)throw TypeError(`Provider id "${e}" refers to a WebAuthn provider.
Please use \`import { signIn } from "next-auth/webauthn"\` instead.`);let p=`${c}/${"credentials"===h?"callback":"signin"}/${e}`,b=await u(),f=await fetch(`${p}?${new URLSearchParams(a)}`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...d,csrfToken:b,callbackUrl:n})}),v=await f.json();if(l){let e=v.url??n;window.location.href=e,e.includes("#")&&window.location.reload();return}let j=new URL(v.url).searchParams.get("error")??void 0,y=new URL(v.url).searchParams.get("code")??void 0;return f.ok&&await i._getSession({event:"storage"}),{error:j,code:y,status:f.status,ok:f.ok,url:j?null:v.url}}async function h(e){let{redirect:t=!0,redirectTo:a=e?.callbackUrl??window.location.href}=e??{},r=o(i),s=await u(),l=await fetch(`${r}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:s,callbackUrl:a})}),n=await l.json();if((null===d&&(d="undefined"==typeof BroadcastChannel?{postMessage:()=>{},addEventListener:()=>{},removeEventListener:()=>{},name:"next-auth",onmessage:null,onmessageerror:null,close:()=>{},dispatchEvent:()=>!1}:new BroadcastChannel("next-auth")),d).postMessage({event:"session",data:{trigger:"signout"}}),t){let e=n.url??a;window.location.href=e,e.includes("#")&&window.location.reload();return}return await i._getSession({event:"storage"}),n}a.createContext?.(void 0),e.s(["signIn",()=>x,"signOut",()=>h],26732)},48805,e=>{"use strict";var t=e.i(43476),a=e.i(26732);function r(){return(0,t.jsx)("button",{onClick:()=>(0,a.signOut)({callbackUrl:"/login"}),className:"inline-flex items-center justify-center rounded-2xl border border-rose-500/40 px-5 py-2 text-sm font-semibold text-rose-200 transition hover:border-rose-400",children:"Cerrar sesión"})}e.s(["default",()=>r])},52681,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566);function s({initialTrip:e}){let s=(0,r.useRouter)(),[l,o]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),[d,c]=(0,a.useState)({name:e?.name??"",startDate:e?.startDate??"",endDate:e?.endDate??"",destinations:e?.destinations??""}),u=async t=>{t.preventDefault(),o(!0),i(null);try{let t=e?"PUT":"POST",a=e?`/api/trip/${e.id}`:"/api/trip",r=await fetch(a,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!r.ok){let e=await r.json().catch(()=>null);i(e?.error??"Error al guardar el viaje.");return}let l=await r.json();await fetch("/api/trip/active",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:l.id})}),s.push("/"),s.refresh()}catch(e){console.error("Error al guardar viaje:",e),i("No se pudo conectar con el servidor.")}finally{o(!1)}},m=e=>{let{name:t,value:a}=e.target;c(e=>({...e,[t]:a}))};return(0,t.jsxs)("div",{className:"rounded-3xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-black/30",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:e?"Editar viaje":"Nuevo viaje"}),(0,t.jsxs)("form",{onSubmit:u,className:"mt-5 flex flex-col gap-4",children:[n&&(0,t.jsx)("div",{className:"rounded-xl border border-red-800 bg-red-900/20 p-3 text-sm text-red-300",children:n}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{htmlFor:"name",className:"text-sm font-medium text-slate-200",children:"Nombre del viaje"}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:d.name,onChange:m,required:!0,maxLength:100,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 placeholder:text-slate-500 focus:border-slate-500 focus:outline-none",placeholder:"Ej: Vacaciones en Europa"})]}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{htmlFor:"startDate",className:"text-sm font-medium text-slate-200",children:"Fecha de inicio"}),(0,t.jsx)("input",{type:"date",id:"startDate",name:"startDate",value:d.startDate,onChange:m,required:!0,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 focus:border-slate-500 focus:outline-none"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{htmlFor:"endDate",className:"text-sm font-medium text-slate-200",children:"Fecha de fin"}),(0,t.jsx)("input",{type:"date",id:"endDate",name:"endDate",value:d.endDate,onChange:m,required:!0,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 focus:border-slate-500 focus:outline-none"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{htmlFor:"destinations",className:"text-sm font-medium text-slate-200",children:"Destinos"}),(0,t.jsx)("textarea",{id:"destinations",name:"destinations",value:d.destinations,onChange:m,required:!0,maxLength:500,rows:3,className:"rounded-xl border border-slate-700 bg-slate-900/60 px-4 py-2 text-slate-100 placeholder:text-slate-500 focus:border-slate-500 focus:outline-none",placeholder:"Ej: Paris, Roma, Barcelona"})]}),(0,t.jsx)("button",{type:"submit",disabled:l,className:"mt-2 rounded-xl bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-emerald-500 disabled:cursor-not-allowed disabled:opacity-50",children:l?"Guardando...":e?"Actualizar viaje":"Crear viaje"})]})]})}e.s(["default",()=>s])},35780,e=>{"use strict";var t=e.i(43476),a=e.i(18566),r=e.i(71645);function s({tripId:e,isOpen:a,onClose:s}){let[l,o]=(0,r.useState)(""),[n,i]=(0,r.useState)("EDITOR"),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(null),[p,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{a&&f()},[a,e]);let f=async()=>{try{let t=await fetch(`/api/trip/${e}/share`);if(t.ok){let e=await t.json();c(e.sharedUsers||[])}}catch(e){console.error("Error loading shared users:",e)}},v=async t=>{if(t.preventDefault(),h(null),b(null),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l))return void h("Por favor ingresa un email válido");m(!0);try{let t=await fetch(`/api/trip/${e}/share`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,role:n})}),a=await t.json();if(!t.ok)return void h(a.error||"Error al compartir el viaje");b(`Viaje compartido con ${l}`),o(""),i("EDITOR"),f()}catch(e){h("No se pudo conectar con el servidor")}finally{m(!1)}},j=async t=>{h(null),b(null);try{let a=await fetch(`/api/trip/${e}/share`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t})});if(!a.ok){let e=await a.json();h(e.error||"Error al eliminar acceso");return}b("Acceso eliminado"),f()}catch(e){h("No se pudo conectar con el servidor")}};return a?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:s,children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-3xl border border-slate-800 bg-slate-900 p-6 shadow-lg",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Compartir viaje"}),(0,t.jsx)("button",{onClick:s,className:"text-slate-400 hover:text-slate-200",children:"✕"})]}),x&&(0,t.jsx)("div",{className:"mb-4 rounded-2xl border border-rose-500/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:x}),p&&(0,t.jsx)("div",{className:"mb-4 rounded-2xl border border-emerald-500/30 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-200",children:p}),(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-300",children:"Email del usuario"}),(0,t.jsx)("input",{type:"email",id:"email",value:l,onChange:e=>o(e.target.value),required:!0,className:"mt-1 w-full rounded-2xl border border-slate-700 bg-slate-800 px-4 py-2 text-sm text-slate-100 placeholder-slate-500 focus:border-cyan-400 focus:outline-none",placeholder:"usuario@ejemplo.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-slate-300",children:"Permisos"}),(0,t.jsxs)("select",{id:"role",value:n,onChange:e=>i(e.target.value),className:"mt-1 w-full rounded-2xl border border-slate-700 bg-slate-800 px-4 py-2 text-sm text-slate-100 focus:border-cyan-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"EDITOR",children:"Editor (puede ver y editar)"}),(0,t.jsx)("option",{value:"VIEWER",children:"Visualizador (solo puede ver)"})]})]}),(0,t.jsx)("button",{type:"submit",disabled:u,className:"w-full rounded-2xl bg-cyan-400 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:bg-cyan-300 disabled:cursor-not-allowed disabled:opacity-70",children:u?"Compartiendo...":"Compartir"})]}),d.length>0&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h3",{className:"mb-3 text-sm font-medium text-slate-300",children:"Usuarios con acceso"}),(0,t.jsx)("div",{className:"space-y-2",children:d.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-2xl border border-slate-800 bg-slate-900/70 px-4 py-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-slate-100",children:e.name||e.email}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"OWNER"===e.role?"Propietario":"EDITOR"===e.role?"Editor":"Visualizador"})]}),"OWNER"!==e.role&&(0,t.jsx)("button",{onClick:()=>j(e.id),className:"text-xs text-rose-400 hover:text-rose-300",children:"Eliminar"})]},e.id))})]})]})}):null}function l({trips:e}){let l=(0,a.useRouter)(),[o,n]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),h=async e=>{n(null),d(e);try{let t=await fetch("/api/trip/active",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok){let e=await t.json().catch(()=>null);n(e?.error??"No se pudo seleccionar el viaje.");return}l.push("/"),l.refresh()}catch(e){console.error("Error al seleccionar viaje:",e),n("No se pudo conectar con el servidor.")}finally{d(null)}},p=async e=>{if(window.confirm("Eliminar este viaje? Se borraran todos sus dias y elementos.")){n(null),d(e);try{let t=await fetch(`/api/trip/${e}`,{method:"DELETE"});if(!t.ok){let e=await t.json().catch(()=>null);n(e?.error??"No se pudo eliminar el viaje.");return}l.refresh()}catch(e){console.error("Error al eliminar viaje:",e),n("No se pudo conectar con el servidor.")}finally{d(null)}}};return(0,t.jsxs)("div",{className:"rounded-3xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-black/30",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Tus viajes"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-slate-300",children:"Selecciona un viaje para abrir su calendario."}),o?(0,t.jsx)("div",{className:"mt-4 rounded-2xl border border-rose-500/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:o}):null,(0,t.jsx)("div",{className:"mt-4 flex flex-col gap-3",children:0===e.length?(0,t.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-700 bg-slate-900/40 p-4 text-sm text-slate-400",children:"Todavia no hay viajes creados."}):e.map(e=>(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-4 shadow-lg shadow-black/20",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-100",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:e.dates}),e.destinations?(0,t.jsxs)("p",{className:"text-xs text-slate-400",children:["Destinos: ",e.destinations]}):null]}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>h(e.id),disabled:i===e.id,className:"inline-flex items-center justify-center rounded-2xl bg-cyan-400 px-4 py-2 text-xs font-semibold text-slate-950 transition hover:bg-cyan-300 disabled:cursor-not-allowed disabled:opacity-70",children:i===e.id?"Abriendo...":"Usar este viaje"}),(0,t.jsx)("button",{type:"button",onClick:()=>l.push(`/setup?edit=${e.id}`),className:"inline-flex items-center justify-center rounded-2xl border border-slate-700 px-4 py-2 text-xs font-semibold text-slate-200 transition hover:border-slate-500",children:"Editar"}),(0,t.jsx)("button",{type:"button",onClick:()=>{x(e.id),u(!0)},className:"inline-flex items-center justify-center rounded-2xl border border-emerald-500/40 px-4 py-2 text-xs font-semibold text-emerald-200 transition hover:border-emerald-400",children:"Compartir"}),(0,t.jsx)("button",{type:"button",onClick:()=>p(e.id),disabled:i===e.id,className:"inline-flex items-center justify-center rounded-2xl border border-rose-500/40 px-4 py-2 text-xs font-semibold text-rose-200 transition hover:border-rose-400 disabled:cursor-not-allowed disabled:opacity-70",children:"Eliminar"})]})]},e.id))}),m&&(0,t.jsx)(s,{tripId:m,isOpen:c,onClose:()=>{u(!1),x(null)}})]})}e.s(["default",()=>l],35780)}]);